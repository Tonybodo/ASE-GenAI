Nested Loop Left Join  (cost=... rows=... width=...)
  Join Filter: (COALESCE(flc.foreign_like_count, 0) >= (ml.total_likes / 2.0))
  ->  Gather  (cost=... rows=... width=...)
        Workers Planned: X
        ->  Hash Join  (cost=... rows=... width=...)
              Hash Cond: (ml.m_messageid = flc.m_messageid)
              ->  HashAggregate  (cost=... rows=... width=...)
                    Group Key: ml.m_messageid
                    ->  Nested Loop  (cost=... rows=... width=...)
                          ->  HashAggregate  (cost=... rows=... width=...)
                                Group Key: m.m_messageid, m.m_creatorid
                                Filter: (COUNT(DISTINCT l.l_personid) >= 20)
                                ->  Hash Join  (cost=... rows=... width=...)
                                      Hash Cond: (l.l_messageid = m.m_messageid)
                                      ->  Seq Scan on likes l  (cost=... rows=... width=...)
                                      ->  Seq Scan on message m  (cost=... rows=... width=...)
                                            Filter: (m_length > 100)
                          ->  Index Scan using likes_pkey on likes l  (cost=... rows=1 width=...)
                                Index Cond: (l_messageid = ml.m_messageid)
              ->  HashAggregate  (cost=... rows=... width=...)
                    Group Key: flc.m_messageid
                    ->  Hash Join  (cost=... rows=... width=...)
                          Hash Cond: (fl.m_messageid = flc.m_messageid)
                          ->  HashAggregate  (cost=... rows=... width=...)
                                Group Key: fl.m_messageid, fl.liker_id
                                ->  Hash Join  (cost=... rows=... width=...)
                                      Hash Cond: (l.m_messageid = fl.m_messageid)
                                      ->  Seq Scan on likes l  (cost=... rows=... width=...)
                                      ->  Seq Scan on foreign_likers fl  (cost=... rows=... width=...)
                          ->  Seq Scan on foreign_likes_counts flc  (cost=... rows=... width=...)
  ->  Left Join  (cost=... rows=... width=...)
        ->  Nested Loop Left Join  (cost=... rows=... width=...)
              ->  Nested Loop  (cost=... rows=... width=...)
                    ->  Seq Scan on first_foreign_liker ffl  (cost=... rows=... width=...)
                    ->  Index Scan using person_pkey on person_names pn  (cost=... rows=1 width=...)
                          Index Cond: (p_personid = ffl.liker_id)
        ->  Seq Scan on person_names pn  (cost=... rows=... width=...)
